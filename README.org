#+TITLE: test spicy with nix
#+AUTHOR: GTrunSec
#+EMAIL: gtrunsec@hardenedlinux.org
#+DATE: 21 August 2020
#+DESCRIPTION:
#+KEYWORDS:
#+LANGUAGE:  en cn
#+SETUPFILE: ~/Documents/my-blog/public/theme/org-html-themes/setup/theme-readtheorg.setup
#+hugo_publishdate: (0 5)
#+hugo_auto_set_lastmod: t
#+HUGO_categories:
#+HUGO_tags:
#+OPTIONS:   H:3 num:t toc:t \n:nil @:t ::t |:t ^:nil -:t f:t *:t <:t
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport

- All of commands related to https://docs.zeek.org/projects/spicy/en/latest/getting-started.html


 -  built Spicy with JIT support


#+begin_src sh  :exports both :results output
./result/bin/spicyc -j hello.spicy
#+end_src

:results:
In file included from Test.cc:6:
In file included from /nix/store/ac4z9smhi4wcq98yh9aqc0i4bll1pszb-spicy/include/hilti/rt/libhilti.h:5:
/nix/store/ac4z9smhi4wcq98yh9aqc0i4bll1pszb-spicy/include/hilti/rt/autogen/config.h:5:10: fatal error: 'string' file not found
#include <string>
         ^~~~~~~~
1 error generated.
[error] jit: failed to execute compilation action.
[error] jit: failed to compile C++ code unit Test to bitcode
[error] spicyc: JIT compilation failed

:end:
- To compile Spicy code into an actual executable on disk, use ~spicy-build~:


#+begin_src shell :exports both :results output :session
./result/bin/spicy-build -o a.out hello.spicy
#+end_src

:results:
/nix/store/1ar9gcmvikdk1wij0cw4fnwvl5i07ag1-binutils-2.31.1/bin/ld: cannot find -lz
clang-9: error: linker command failed with exit code 1 (use -v to see invocation)

:end:
